/*! For license information please see modal.min.js.LICENSE.txt */
void 0===Craft.EntryTemplates&&(Craft.EntryTemplates={}),Craft.EntryTemplates.Modal=Garnish.Base.extend({$settings:null,$elements:{},$default:{},init(t){Object.defineProperty(this.$elements,"__esModule",{value:!0}),this.$settings=t,this.$elements.default=class{constructor(t){var e;this.id=t.id,this.title=t.title,this.preview=null!==(e=t.preview)&&void 0!==e?e:1,this.description=t.description,this.$button=$(this._button())}_button(){const t=$("<button />").append($("<p />").text(this.title)),e=$("<div />").appendTo(t);return 1===this.preview?t.addClass("is-empty"):e.append($("<img />").attr("src",this.preview)),null!==this.description&&t.append($('<p class="description" />').text(this.description)),t}},this._addDefault(),this._createModal()},_button(){const t=$("<button />").append($("<p />").text(this.title));return $("<div />").appendTo(t),t},_footer(){let t=document.createElement("div");t.classList.add("buttons","right");let e=document.createElement("button");return e.setAttribute("type","button"),e.setAttribute("tabindex","0"),e.classList.add("btn","template-cancel-btn"),e.innerText="Cancel",t.append(e),t},_addDefault(){Object.defineProperty(this.$default,"__esModule",{value:!0}),this.$default.default={0:"Blank",Blank:0}},_createModal(){const t=$('<div class="modal templates_modal" />');this.garnishModal=new Garnish.Modal(t),this.garnishModal.hide();const e=document.querySelector("button.template-modal"),a=this;e.addEventListener("click",(function(){a.garnishModal.show()}));const n=$('<div class="modal_body" />').appendTo(t).append($('<h2 class="modal_heading" />').text(Craft.t("entrytemplates","Choose a template"))),s=$('<div class="modal_container" />').appendTo(n),i=$('<div class="modal_inner" />').appendTo(s),d=($('<div class="footer" />').append(this._footer()).appendTo(s),document.querySelector("button.template-cancel-btn"));d&&d.addEventListener("click",(function(){a.garnishModal.hide()}));const l=this.$elements,o=this.$settings;this.$default,this.contentTemplates=[],this.contentTemplates.push(...o.entryTemplates.map((t=>new l.default(t)))),this.contentTemplates.forEach((e=>{$('<div class="modal_block" />').append(e.$button).appendTo(i),e.$button.on("activate",(a=>{if(void 0===e.id)this.garnishModal.hide();else if(confirm("Are you sure you want to apply this template? It will remove any content you may have already added.")){t.addClass("applying");const a={elementId:o.elementId,entryTemplateId:e.id};Craft.sendActionRequest("POST","entrytemplates/templates/apply",{data:a}).then((t=>{window.location.href=t.data.redirect})).catch((e=>{var a;t.removeClass("applying"),Craft.cp.displayError(null!==(a=e.error)&&void 0!==a?a:Craft.t("entrytemplates","An unknown error occurred."))}))}}))}))}});